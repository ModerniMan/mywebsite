<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>קורות חיים | ליפז נוסן</title>
    
    <meta name="description" content="קורות החיים ותיק העבודות של ליפז נוסן. ניסיון בשירות, תמיכה טכנית וניהול פרויקטים טכנולוגיים.">
    <meta property="og:title" content="קורות חיים | ליפז נוסן">
    <meta property="og:description" content="ניסיון בשירות, תמיכה טכנית וניהול פרויקטים טכנולוגיים.">
    <meta property="og:image" content="">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="resume-container">
        <nav>
            <a href="index.html" class="nav-button back-link"><i class="fas fa-arrow-right"></i> חזרה לכרטיס הביקור</a>
            <button class="nav-button export" onclick="window.print()"><i class="fas fa-file-pdf"></i> ייצוא ל-PDF</button>
        </nav>

        <header id="main-header"></header>
        
        <section id="summary" class="section"></section>
        
        <section id="github-portfolio" class="section">
             <h2><i class="fab fa-github section-icon"></i>תיק עבודות מ-GitHub</h2>
            <div id="portfolio-grid"></div>
            <p id="portfolio-loading">טוען פרויקטים...</p>
        </section>

        <section id="experience" class="section"></section>
        <section id="skills" class="section"></section>
        <section id="education" class="section"></section>
    </div>

    <!-- === טעינת קובץ הנתונים === -->
    <script src="data.js"></script>
    <script>
        async function fetchGitHubData(username) {
            const portfolioGrid = document.getElementById('portfolio-grid');
            const loadingMsg = document.getElementById('portfolio-loading');
            const profilePicElement = document.getElementById('profile-pic');
            const ogImageMeta = document.querySelector('meta[property="og:image"]');

            try {
                // Fetch user profile data
                const userResponse = await fetch(`https://api.github.com/users/${username}`);
                if (userResponse.ok) {
                    const userData = await userResponse.json();
                    if (userData.avatar_url) {
                        if (profilePicElement) profilePicElement.src = userData.avatar_url;
                        if (ogImageMeta) ogImageMeta.setAttribute('content', userData.avatar_url);
                    }
                }

                // Fetch user repositories
                const reposResponse = await fetch(`https://api.github.com/users/${username}/repos?sort=updated&per_page=6`);
                if (reposResponse.ok) {
                    const repos = await reposResponse.json();
                    loadingMsg.style.display = 'none';
                    
                    repos.forEach(repo => {
                        if (repo.fork) return;
                        const card = document.createElement('div');
                        card.className = 'repo-card';
                        card.innerHTML = `<h3><a href="${repo.html_url}" target="_blank" rel="noopener noreferrer">${repo.name}</a></h3><p>${repo.description || 'אין תיאור לפרויקט זה.'}</p><div class="repo-footer"><div class="repo-language">${repo.language ? `<span>${repo.language}</span>` : ''}</div><div class="repo-stats"><i class="fas fa-star"></i> ${repo.stargazers_count}</div></div>`;
                        portfolioGrid.appendChild(card);
                    });
                } else {
                     throw new Error('Failed to fetch repos');
                }
            } catch (error) {
                loadingMsg.innerText = "לא ניתן היה לטעון את הפרויקטים מ-GitHub.";
                console.error(error);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const data = siteData; // Using the object from data.js
            const p = data.personal;
            const linkedinUser = p.linkedin.split('/').pop();

            // Populate Header
            const header = document.getElementById('main-header');
            header.innerHTML = `
                <img id="profile-pic" alt="תמונת פרופיל של ${p.fullName}">
                <h1>${p.fullName}</h1>
                <div class="contact-info">
                    <a href="mailto:${p.email}" class="contact-item"><i class="fas fa-envelope"></i><span class="print-only">מייל: </span><span>${p.email}</span></a>
                    <div class="contact-item"><i class="fas fa-phone"></i><span class="print-only">טלפון: </span><span>${p.phone}</span></div>
                    <a href="${p.linkedin}" target="_blank" rel="noopener noreferrer" class="contact-item"><i class="fab fa-linkedin"></i><span class="print-only">לינקדאין: </span><span>${linkedinUser}</span></a>
                </div>`;
            
            // Populate Sections
            document.getElementById('summary').innerHTML = `<h2><i class="fas fa-user section-icon"></i>תמצית</h2><p>${data.summary}</p>`;
            document.getElementById('experience').innerHTML = `<h2><i class="fas fa-briefcase section-icon"></i>ניסיון תעסוקתי</h2>` + data.experience.map(j => `<div class="job"><div class="dates">${j.dates}</div><div class="job-title">${j.title}</div><div class="company">${j.company}</div><ul>${j.points.map(p => `<li>${p}</li>`).join('')}</ul></div>`).join('');
            document.getElementById('education').innerHTML = `<h2><i class="fas fa-graduation-cap section-icon"></i>השכלה</h2>` + data.education.map(e => `<div class="education-item"><div class="degree">${e.degree}</div><div class="institution">${e.institution}</div><p>${e.details}</p></div>`).join('');
            document.getElementById('skills').innerHTML = `<h2><i class="fas fa-lightbulb section-icon"></i>כישורים ופרויקטים</h2>` + data.skills.map(s => `<div class="project"><div class="project-title">${s.name}</div><p>${s.description}</p></div>`).join('');

            // Fetch dynamic GitHub data
            if (p.githubUser) {
                fetchGitHubData(p.githubUser);
            } else {
                 document.getElementById('github-portfolio').style.display = 'none';
            }
        });
    </script>

</body>
</html>